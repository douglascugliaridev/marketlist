### ====================== API DE TESTES - MARKETLIST ======================
### Ambiente: Desenvolvimento
### Servidor: http://localhost:4000
### Autor: Douglas Cugliari
### =============================================================================

### ====================== VARIÁVEIS GLOBAIS ======================
@baseUrl = http://localhost:4000
@contentType = application/json
@userEmail = usuario2@teste.dev
@userPassword = #Senha123

### ====================== AUTENTICAÇÃO (AUTH) ======================

### ---------------------- REGISTRAR USUÁRIO ----------------------
# @name register
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "name": "Usuario Teste",
  "email": "{{userEmail}}",
  "password": "{{userPassword}}"
}

###

@userId = {{register.response.body.userId}}

###

### ---------------------- LOGIN ----------------------
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "{{userEmail}}",
  "password": "{{userPassword}}"
}

###

@token = {{login.response.body.token}}
@userId = {{login.response.body.userId}}

###

### ====================== MERCADOS (MARKETS) ======================

### ---------------------- CRIAR MERCADO ----------------------
# @name createMarket
POST {{baseUrl}}/market
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "name": "Supermercado Sul do Rio",
  "userId": "{{userId}}"
}

###

@marketId = {{createMarket.response.body.id}}

###

### ---------------------- LISTAR TODOS OS MERCADOS ----------------------
GET {{baseUrl}}/market
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR MERCADO POR ID ----------------------
GET {{baseUrl}}/market/eb2b785c-2791-4f93-8218-5f02618db139
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- ATUALIZAR MERCADO ----------------------
PATCH {{baseUrl}}/market/eb2b785c-2791-4f93-8218-5f02618db139
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "name": "Supermercado Central - Atualizado"
}

###

### ---------------------- EXCLUIR MERCADO ----------------------
DELETE {{baseUrl}}/market/eb2b785c-2791-4f93-8218-5f02618db139
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ====================== PRODUTOS (PRODUCTS) ======================

### ---------------------- CRIAR PRODUTO ----------------------
# @name createProduct
POST {{baseUrl}}/product
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "name": "Macarrão",
  "brand": "Galo",
  "listDefault": true,
  "userId": "{{userId}}"
}

###

@productId = {{createProduct.response.body.id}}

###

### ---------------------- BUSCAR PRODUTO POR ID ----------------------
GET {{baseUrl}}/product/1f9651c1-34ea-4d8d-83cf-a0184b2828ca
Content-Type: {{contentType}}
Authorization: Bearer {{token}}


###

### ---------------------- BUSCAR PRODUTOS POR NOME ----------------------
GET {{baseUrl}}/product/search?name=arroz
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR PRODUTOS POR MARCA ----------------------
GET {{baseUrl}}/product/brand?brand=ligeirinho
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR PRODUTOS DA LISTA PADRÃO ----------------------
GET {{baseUrl}}/product/default?userId={{userId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR PRODUTOS POR USUÁRIO (SEM PAGINAÇÃO) ----------------------
GET {{baseUrl}}/product?userId={{userId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR PRODUTOS POR USUÁRIO (COM PAGINAÇÃO) ----------------------
### Primeira página com 5 itens
GET {{baseUrl}}/product?userId={{userId}}&page=1&limit=5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### Segunda página com 5 itens
GET {{baseUrl}}/product?userId={{userId}}&page=2&limit=5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### Terceira página com 5 itens (última página)
GET {{baseUrl}}/product?userId={{userId}}&page=3&limit=5
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### Teste com limit diferente - Primeira página com 3 itens
GET {{baseUrl}}/product?userId={{userId}}&page=1&limit=3
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### Teste com limit diferente - Segunda página com 3 itens
GET {{baseUrl}}/product?userId={{userId}}&page=2&limit=3
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- ATUALIZAR PRODUTO ----------------------
PATCH {{baseUrl}}/product/9993fc1d-d4a8-4c06-ac25-70bb86ff7484
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "brand": "Tio João"
}

###

### ---------------------- EXCLUIR PRODUTO ----------------------
DELETE {{baseUrl}}/product/ed8cc005-17ff-46d3-8b74-277a07fdfff6
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ====================== COMPRAS (PURCHASES) ======================

### ---------------------- CRIAR COMPRA ----------------------
# @name createPurchase
POST {{baseUrl}}/purchase
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "name": "Compra de Janeiro 2026",
  "userId": "{{userId}}",
  "marketId": "{{marketId}}"
}

###

@purchaseId = {{createPurchase.response.body.id}}

###

### ---------------------- LISTAR COMPRAS DO USUÁRIO ----------------------
GET {{baseUrl}}/purchase?userId={{userId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- BUSCAR COMPRA POR ID ----------------------
GET {{baseUrl}}/purchase/{{purchaseId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- ATUALIZAR COMPRA ----------------------
PATCH {{baseUrl}}/purchase/{{purchaseId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "name": "Compra de Janeiro 2026 - Atualizada"
}

###

### ---------------------- EXCLUIR COMPRA ----------------------
DELETE {{baseUrl}}/purchase/{{purchaseId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ====================== ITENS DE PRODUTO (PRODUCT ITEMS) ======================

### ---------------------- ADICIONAR ITEM À COMPRA ----------------------
# @name createProductItem

@productId = 9e934961-54b2-43ee-a51c-8af225aa242c
@purchaseId = d8e9da83-8f21-49c7-b46b-893170b41a50

POST {{baseUrl}}/product-item
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "productId": "{{productId}}",
  "purchaseId": "{{purchaseId}}",
  "price": 15.99,
 // "previousPrice": 20.99,
  "amount": 3
}

###

@productItemId = {{createProductItem.response.body.id}}

###

### ---------------------- LISTAR ITENS DA COMPRA ----------------------
GET {{baseUrl}}/product-item/purchase/d8e9da83-8f21-49c7-b46b-893170b41a50
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

### ---------------------- ATUALIZAR ITEM DA COMPRA ----------------------
PATCH {{baseUrl}}/product-item/b9548ec6-1bb7-44e4-b1b3-cb04f34cde6f
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "purchaseId": "d8e9da83-8f21-49c7-b46b-893170b41a50",
  "price": 24.99,
  "amount": 3
}

###

### ---------------------- EXCLUIR ITEM DA COMPRA ----------------------
DELETE {{baseUrl}}/product-item/{{productId}}/{{purchaseId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

###

